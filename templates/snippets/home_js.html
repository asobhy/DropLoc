

<script>
     const addPhotoBtn = document.querySelector('#addphotoBtn')
    const ImageContainer1 = document.querySelector('#ImageContainer1')
    const ImageContainer2 = document.querySelector('#ImageContainer2')
    var imageField = document.getElementById("photoImageID")
    const photoid = document.querySelector('#photoid')
    const cancelBtn = document.querySelector('#cancelBtn')
    const postBtn = document.querySelector('#postbtnid')
    const postInput = document.querySelector('#postinputid')
    const photoBtn1 = document.querySelector('#photoBtn1')
   
    //const idProfileImage = document.querySelector('#id_profile_image')

	var imageFile;
	var base64ImageString;
	

    function readURL(input){
        postBtn.removeAttribute('disabled')
        ImageContainer1.style.display = "none"
		if(input.files && input.files[0]){
			var reader = new FileReader()

			reader.onload = function(e){
				//disableImageOverlay()
				var image = e.target.result
                console.log(image)
                ImageContainer2.style.display = "block"
                console.log(imageField)
                //imageField.style.display = "d-flex"
				imageField.src = image
                imageFile =	image
						
			}
			reader.readAsDataURL(input.files[0])
            
		}
	}


    function setImageCropProperties(image, x, y, width, height){
		imageFile = image
	}

    function isImageSizeValid(image){
		var startIndex = image.indexOf("base64,") + 7
		var base64str = image.substr(startIndex)
		var decoded = atob(base64str)
		if(decoded.length >= "{{ DATA_UPLOAD_MAX_MEMORY_SIZE }}"){
			return null
		}
		return base64str
	}

    function cropImage(image, x, y, width, height){
		//console.log(image)
		
	}
    



// <!------------ Script to add post photo view Button --------------->

    const photoViewButton = (e) =>{
        e.preventDefault()
        ImageContainer1.style.display = "block"
    }
    addPhotoBtn.addEventListener('click', photoViewButton)
    photoid.addEventListener('click', photoViewButton)

//<----------------- END ---------------------------------------->     
    

// <!------------ Script to remove post photo view Button -------------->

    cancelBtn.addEventListener('click', (e) =>{
        e.preventDefault()
        ImageContainer1.style.display = "none"
        ImageContainer2.style.display = "none"
        addPhotoBtn.style.pointerEvents = ""
        
    })

// <----------------- END ---------------------------------------->



// <-------------- Script to create a post ----------------------->

postBtn.addEventListener('click', (e) =>{
    e.preventDefault()
    var inputPostValue = postInput.value.trim()
    fetch(`${url}/create-post/`, {
        body: JSON.stringify({
            inputPostValue: inputPostValue,
            imgPostValue: imageFile 
        }),
        method: 'POST',
        headers:{
            'X-CSRFToken': "{{csrf_token}}",
            "Content-Type": "application/json"
        }
    }).then((res) => res.json()).then((data) =>{
        console.log(data)
    })
    window.location.reload()
})

// <------------------------- END --------------------------------------->



// <-------------- Script Enabling and disablng button -------------------->

postInput.addEventListener('keyup', (e) =>{
    e.preventDefault()
    
    if(e.target.value.length > 0){
        postBtn.removeAttribute('disabled')
    }else{
        postBtn.setAttribute('disabled', 'disabled')
    }
})

// <------------------------------- END -------------------------------------->


photoBtn1.addEventListener("click", function(event){
    addPhotoBtn.style.pointerEvents = "none"
	document.getElementById("id_profile_image").click()
})



</script>




